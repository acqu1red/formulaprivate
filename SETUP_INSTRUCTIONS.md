# Инструкции по настройке базы данных

## Проблема
После удаления SQL файлов пользователи не могут писать сообщения, а админ панель не отображается из-за отсутствия администраторов.

## Решение
Созданы все необходимые SQL файлы с максимально открытой политикой безопасности.

## Файлы для выполнения

### 1. Создание таблиц
Выполните файл `create_tables.sql` в Supabase SQL Editor:
- Создает все необходимые таблицы
- Добавляет индексы для оптимизации
- Вставляет администраторов с ID: 708907063 и 7365307696

### 2. Настройка политик безопасности
Выполните файл `simple_policies.sql`:
- Включает Row Level Security (RLS)
- Создает максимально открытые политики (все пользователи могут читать/писать)
- Создает функцию `get_admin_conversations()` для админ панели

### 3. Добавление администраторов
Выполните файл `add_admin.sql`:
- Добавляет администраторов в таблицы users и admins
- Создает диалоги для администраторов
- Проверяет корректность добавления

### 4. Очистка (опционально)
Если нужно очистить данные, выполните `cleanup.sql`:
- Удаляет все сообщения и пользователей (кроме администраторов)
- Сбрасывает счетчики автоинкремента

## Администраторы
- **admin1**: ID 708907063
- **admin2**: ID 7365307696

## Политики безопасности
Все политики настроены максимально открыто:
- Все пользователи могут читать все данные
- Все пользователи могут создавать записи
- Все пользователи могут обновлять записи
- Все пользователи могут удалять записи

## Проверка работы
1. Запустите бота
2. Отправьте сообщение от обычного пользователя
3. Проверьте, что администраторы получают уведомления
4. Используйте команду `/messages` для просмотра админ панели

## Команды бота для администраторов
- `/messages` - просмотр сообщений от пользователей
- `/cancel` - отмена режима ответа
